<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ESP32 TEST</title>
    <script src="https://cdn.jsdelivr.net/npm/esptool-js@0.4.0/bundle.js"></script>
</head>
<body style="background:#000; color:#0f0; text-align:center; padding:50px; font-family:monospace;">
    <h1>ESP32 WEB TEST</h1>
    <p id="st">กำลังรอตัวช่วย...</p>
    <button id="go" style="padding:20px; display:none;">กดเพื่อเชื่อมต่อ</button>

    <script>
        const check = setInterval(() => {
            if (window.esptooljs) {
                clearInterval(check);
                document.getElementById('st').innerText = "✅ ตัวช่วยมาแล้ว! พร้อมลุย";
                document.getElementById('go').style.display = "inline-block";
            }
        }, 500);

        document.getElementById('go').onclick = async () => {
            const port = await navigator.serial.requestPort();
            await port.open({ baudRate: 115200 });
            const transport = new window.esptooljs.Transport(port);
            const esploader = new window.esptooljs.ESPLoader(transport, 115200);
            document.getElementById('st').innerText = "เชื่อมต่อสำเร็จ!";
            await esploader.main();
        };
    </script>
</body>
</html>
